### Расчет времени выполнения процессов

---

#### **Формула итогового времени выполнения**
Итоговое время выполнения определяется как:
$$
T_{\text{итог}} = T_{\text{процесса}} + \max(T_{\text{ожидания зависимых}})
$$

Где:
- $T_{\text{процесса}}$ — время выполнения самого процесса.
- $T_{\text{ожидания зависимых}}$ — максимальное время завершения всех процессов, от которых зависит текущий.

---

### Решение в Excel без автоматизации

1. **Удаление заголовков:**
   - Удаляем строку с названиями столбцов для упрощения работы.

2. **Расчет времени выполнения (столбец D):**
   - Для независимых процессов ($D = C$):
     ```excel
     =C2
     ```
   - Для зависимых процессов ($D = B + \max(D_{\text{завис\_1}}, D_{\text{завис\_2}})$):
     ```excel
     =B2 + МАКС(ВПР(F2; $A$2:$D$100; 4; 0); ВПР(G2; $A$2:$D$100; 4; 0))
     ```

3. **Поиск итогового времени выполнения:**
   - Находим максимальное значение в столбце $D$:
     ```excel
     =МАКС(D:D)
     ```

---

### Решение в Excel с автоматизацией

4. **Разделение столбца с ID зависимостей:**
   - Используем функцию "Текст по столбцам" → разделитель: точка с запятой.
   - Сохраняем результаты в дополнительные столбцы ($F$, $G$, $H$).

5. **Добавление фиктивного процесса:**
   - Создаем строку с ID=0 и временем выполнения=0.

6. **Расчет итогового времени выполнения (столбец I):**
   - Формула для столбца $I$:
     ```excel
     =B2 + МАКС(F2:H2)
     ```
   - Для значений в столбцах $F$, $G$, $H$:
     ```excel
     =ЕСЛИ(F2=""; 0; ВПР(F2; $A$2:$I$100; 9; 0))
     ```

7. **Протягивание формул:**
   - Применяем формулы ко всем строкам таблицы.

8. **Поиск итогового времени выполнения:**
   - Находим максимальное значение в столбце $I$:
     ```excel
     =МАКС(I:I)
     ```

---

#### **Дополнительные условия**

9. **Задержка у зависимых процессов:**
   - Изменяем формулу для столбца $I$:
     ```excel
     =ЕСЛИ(C2=0; B2; B2 + МАКС(F2:H2) + T)
     ```
   - Где $T$ — время задержки.

10. **Неизвестное время процесса:**
   - Заменяем неизвестное время на $0$ и корректируем его после расчетов.

11. **Неизвестный процесс, от которого зависит:**
   - Заменяем неизвестную зависимость на $0$ и обновляем данные при необходимости.

---

### Решение на Python

12. **Копирование данных:**
   - Копируем таблицу в текстовый файл (`22.txt`) без заголовков.

13. **Обработка данных:**
   ```python
   # Инициализация словаря для хранения итоговых времен выполнения
   process_times = {'0': 0}  # Фиктивный процесс с ID=0 и временем=0

   # Чтение данных из файла
   with open('22.txt') as f:
       data = [line.strip().replace(';', ' ').split() for line in f]

   # Обработка данных
   while len(process_times) <= len(data):
       for process in data:
           pid, time, *deps = process  # Разбор строки: ID, время, зависимости
           if all(dep in process_times for dep in deps):  # Проверка наличия всех зависимостей
               process_times[pid] = int(time) + max(process_times.get(dep, 0) for dep in deps)

   # Вывод результата
   print(max(process_times.values()))
   ```

---

#### **Описание кода:**

14. **Инициализация:**
   - Создаем словарь `process_times`, где ключи — ID процессов, а значения — их итоговые времена выполнения.
   - Добавляем фиктивный процесс с ID=0 и временем=0.

15. **Чтение данных:**
   - Считываем данные из файла, разделяя строки по пробелам или точкам с запятой.

16. **Обработка данных:**
   - Проходим по каждому процессу.
   - Проверяем, что все зависимости уже рассчитаны.
   - Вычисляем итоговое время выполнения как сумму времени процесса и максимального времени завершения зависимых процессов.

17. **Вывод результата:**
   - Находим максимальное значение среди всех итоговых времен выполнения.

---

#### **Пример данных в файле (`22.txt`):**
```
1 10
2 20
3 15 1
4 25 1 2
5 5 3 4
```

#### **Пример работы программы:**
18. Начальные значения:
   - Процесс 1: $10$
   - Процесс 2: $20$
   - Процесс 3: $10 + 15 = 25$
   - Процесс 4: $\max(10, 20) + 25 = 45$
   - Процесс 5: $\max(25, 45) + 5 = 50$

19. Итоговое время выполнения:
   ```python
   print(max(process_times.values()))  # 50
   ```

---

### Примечания

20. **Мемоизация:**  
   - Использование словаря `process_times` позволяет избежать повторных вычислений для уже обработанных процессов.

21. **Обработка циклических зависимостей:**  
   - Если в данных присутствуют циклические зависимости, программа может зациклиться. Необходимо добавить проверку на такие случаи.