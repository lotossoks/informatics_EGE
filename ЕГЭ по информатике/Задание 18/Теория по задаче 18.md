### Детальное руководство по решению задач на динамическое программирование в таблицах

---

#### **1. Открытие таблицы**
- Загрузите исходную таблицу для анализа.
- Убедитесь, что данные корректно отображаются и соответствуют условию задачи.

---

#### **2. Выделение границ**
- Определите размер таблицы (например, $m \times n$).
- Отметьте внешние границы таблицы для удобства дальнейшей работы.
- Если в задаче указаны стартовая или конечная точки, выделите их явно.

---

#### **3. Создание копии форматирования**
- Создайте копию таблицы с тем же форматированием, чтобы сохранить визуальную структуру.
- Это поможет избежать путаницы при заполнении значений.

---

#### **4. Ввод стартовых значений**
- Задайте начальные значения в стартовой ячейке (обычно это левый верхний угол).
- Пример: если робот начинает движение с клетки $(1, 1)$, значение этой клетки может быть равно самому себе или нулю, в зависимости от условия.

---

#### **5. Заполнение значений на границах**
- Для ячеек, расположенных вдоль внешних границ таблицы, рассчитайте значения, учитывая доступные пути:
  - **Горизонтальная граница**:  
    ```excel
    =A13 + B1
    ```
    (значение предыдущей ячейки + текущее число).

  - **Вертикальная граница**:  
    ```excel
    =B13 + A2
    ```
    (значение предыдущей ячейки + текущее число).

---

#### **6. Расчет внутренних ячеек**
- Для остальных ячеек используйте функцию **MAX** или **MIN**, выбирая наилучший вариант из возможных предыдущих шагов:
  - **Пример формулы для MAX**:  
    ```excel
    =МАКС(A14 + B2, B13 + B2)
    ```
    (максимум из значений, пришедших сверху или слева).

  - **Если есть диагональное движение**:  
    ```excel
    =МАКС(A14 + B2, B13 + B2, A13 + B2)
    ```
    (добавляется третий вариант — диагональный путь).

- **Совет**:  
  - Если задача требует минимального значения, замените **MAX** на **MIN**.
  - При необходимости можно использовать `Ctrl+H` для быстрой замены всех формул.

---

#### **7. Форматирование таблицы**
- После завершения расчетов верните форматирование из исходной таблицы в обработанную копию.
- Это сделает результат более наглядным и понятным.

---

#### **8. Обработка дополнительных условий**

##### **8.1 Стены и недоступные ячейки**
- Если некоторые ячейки недоступны ("стены"), огораживайте их специальным значением:
  - Для задач на **MAX**: используйте очень маленькое значение (например, `-10000`).
  - Для задач на **MIN**: используйте очень большое значение (например, `10000`).

- Граничные ячейки рядом со стенами рассчитываются как обычно, игнорируя недоступные клетки.

##### **8.2 Несколько финальных точек**
- Если существует несколько конечных точек, выполните расчет для каждой из них одинаковым образом.
- Итоговое решение будет зависеть от максимального или минимального значения среди всех финальных точек.

##### **8.3 Условия на монеты**
- Если робот не берет монеты в определенных клетках, замените значения этих клеток на `0`, чтобы они не влияли на сумму.

##### **8.4 Непроходимые клетки**
- Замените значения непроходимых клеток на минимально выгодные для выбранного подхода:
  - Для **MAX**: `-10000`.
  - Для **MIN**: `10000`.

---

#### **9. Поиск траектории**
- Найдите оптимальный путь с обратного конца:
  - **Для MAX**: найдите максимальную клетку, из которой можно прийти в финальную.
  - **Для MIN**: аналогично, но ищите минимальную клетку.

- Постепенно двигайтесь назад, восстанавливая путь до стартовой точки.

---

#### **10. Особенности формул**
- При использовании знака `$` в формуле, параметр под `$` остается неизменным при автозаполнении:
  - Пример:  
    ```excel
    =$A1 + B$2
    ```
    (фиксация столбца или строки при переносе формулы).

---

### Примечания по расчету

#### **1. Количество путей**
- Количество путей до каждой клетки считается как сумма количества путей из предыдущих клеток:
  - $\text{Пути}_{i,j} = \text{Пути}_{i-1,j} + \text{Пути}_{i,j-1}$
  - Если есть диагональное движение:  
    $\text{Пути}_{i,j} = \text{Пути}_{i-1,j} + \text{Пути}_{i,j-1} + \text{Пути}_{i-1,j-1}$

#### **2. Особенности фигур**
- **Ладья**:  
  - Рассчитывает значения как **MAX**/**MIN** из всех предыдущих клеток в пределах допустимых границ (по горизонтали и вертикали).

- **Конь**:  
  - Учитывает только те клетки, которые достижимы ходом коня.

---

### Пример решения задачи

#### **Условие**:  
Найти максимальную сумму чисел, которую может набрать робот, двигаясь из левой верхней клетки в правую нижнюю. Движение возможно только вправо или вниз.

#### **Алгоритм решения**:
1. **Открытие таблицы**:  
   Загрузите данные в таблицу.

2. **Выделение границ**:  
   Определите размер таблицы ($m \times n$).

3. **Заполнение первой строки и первого столбца**:  
   - Первая строка:  
     ```excel
     =A1 + B1
     ```
   - Первый столбец:  
     ```excel
     =A1 + A2
     ```

4. **Расчет внутренних ячеек**:  
   Для каждой ячейки внутри таблицы используйте формулу:  
   ```excel
   =МАКС(A14 + B2, B13 + B2)
   ```

5. **Обработка дополнительных условий**:  
   - Если есть стены, замените их значения на `-10000`.
   - Если робот не берет монеты в определенных клетках, установите их значения равными `0`.

6. **Поиск траектории**:  
   - Начните с правой нижней клетки.
   - Перемещайтесь назад, выбирая клетку с максимальным значением на каждом шаге.
